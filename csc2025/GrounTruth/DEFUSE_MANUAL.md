# Ground Truth Bomb Defuse Manual
## 地緣真相炸彈拆除完整手冊

---

## 1. 電路板佈局

```
    ┌──────────────────────────────┐
    │ GPIO 8  │  GPIO 0         │  ← 頂部關鍵標記
    │ (Pin 0)  │  (Pin 8)         │
    ├──────────────────────────────┤
    │ GPIO 9-15                 │  ← 右側 (Pin 1-7)
    │ (Pin 1-7)                 │
    ├──────────────────────────────┤
    │ GPIO 22-16                │  ← 底部 (Pin 9-15)
    │ (Pin 9-15)                │     (從左到右)
    └──────────────────────────────┘
```

### Pin 對應表

| 邏輯 Pin | GPIO Pin | 位置 | 說明 |
|-----------|-----------|------|------|
| 0 | 8 | 左上角 | 第一個關鍵標記 |
| 1 | 9 | 右側 |  |
| 2 | 10 | 右側 |  |
| 3 | 11 | 右側 |  |
| 4 | 12 | 右側 |  |
| 5 | 13 | 右側 |  |
| 6 | 14 | 右側 |  |
| 7 | 15 | 右側 |  |
| 8 | 0 | 右上角 | 第二個關鍵標記 |
| 9 | 22 | 底部 |  |
| 10 | 21 | 底部 |  |
| 11 | 20 | 底部 |  |
| 12 | 19 | 底部 |  |
| 13 | 18 | 底部 |  |
| 14 | 17 | 底部 |  |
| 15 | 16 | 底部 |  |

---

## 2. 操作步驟

### 步驟 1：讀取 Seed

在裝置顯示器上會看到：
```
S/N: xxxxxxxxxx
```

**Seed 是 10 個 16 進制字元**
- 格式：0-9 和 a-f
- 範例：`deadbeef01`、`1234567890`、`abcdef0123`

### 步驟 2：計算剪線順序

使用計算工具：
```bash
cd csc2025/GrounTruth
python3 calculate_full_sequence.py
```

輸入你的 seed，工具會生成：
- 完整剪線順序（1-16）
- 快速參考卡
- 詳細說明文件

### 步驟 3：執行拆除

按照計算出的順序依次剪線：

```
步驟 1: 剪斷 GPIO XX (Rank 1)
  → 其餘所有線的 rank -1

步驟 2: 剪斷 GPIO YY (Rank 2)
  → 其餘所有線的 rank -1

步驟 3: 剪斷 GPIO ZZ (Rank 3)
  → 其餘所有線的 rank -1

...以此類推...

步驟 16: 剪斷最後一條線 (Rank 16)
  → 成功！顯示 Flag！
```

---

## 3. 遊戲規則

### 成功條件
- ✅ 剪斷 rank = 1 的線 → 其餘線 rank 全部 -1
- ✅ 繼續剪斷 rank = 1 的線 → 其餘線 rank 全部 -1
- ✅ 直到所有線的 rank = 0 → **WIN!** 看到 Flag

### 失敗條件
- ❌ 剪斷 rank ≠ 1 的線 → **爆炸！** 顯示 "Wrong Wire!"
- ❌ 時間倒數結束 → **爆炸！** 顯示 "Time's up!"

### 重要規則
1. **每次只能剪 rank = 1 的線**
2. **剪對後，所有剩餘線的 rank -1**
3. **必須按順序剪**：1 → 2 → 3 → ... → 16
4. **剪錯任何一步 = 爆炸**

---

## 4. 範例輸出

假設 Seed = `deadbeef01`

```
完整剪線順序
----------------------------------------------------------------------
步驟   GPIO   邏輯 Pin 位置                 描述
----------------------------------------------------------------------
1      10     2         右側                  RIGHT-COLUMN
2      14     6         右側                  RIGHT-COLUMN
3      15     7         右側                  RIGHT-COLUMN
4      11     3         右側                  RIGHT-COLUMN
5      22     9         底部                  BOTTOM-ROW
6      12     4         右側                  RIGHT-COLUMN
7      19     12        底部                  BOTTOM-ROW
8      8      0         ┌─左上角 (GPIO 8)   TOP-LEFT
9      20     11        底部                  BOTTOM-ROW
10     18     13        底部                  BOTTOM-ROW
11     17     14        底部                  BOTTOM-ROW
12     13     5         右側                  RIGHT-COLUMN
13     0      8         ┌─右上角 (GPIO 0)   TOP-RIGHT
14     9      1         右側                  RIGHT-COLUMN
15     21     10        底部                  BOTTOM-ROW
16     16     15        底部                  BOTTOM-ROW
```

---

## 5. 快速參考卡

### 頂部 - 關鍵標記
- GPIO 8 (左上角) - 這是第一個標記點
- GPIO 0 (右上角) - 這是最後一個標記點

### 右側 - GPIO 9-15
- 7 條線從上到下排列
- 對應邏輯 Pin 1-7

### 底部 - GPIO 22-16 (從左到右)
- 7 條線從左到右排列
- 對應邏輯 Pin 9-15

---

## 6. 常見問題

**Q: 我要輸入完整的 "S/N: deadbeef01" 嗎？**
A: 不需要！只輸入 `deadbeef01` 即可（10 個字元）

**Q: 如果剪錯會怎樣？**
A: 立即爆炸，顯示 "Wrong Wire! Kaboomed!" 然後重置

**Q: 時間限制是多久？**
A: 看顯示器上的倒數，通常有幾分鐘時間

**Q: 可以跳過步驟嗎？**
A: 不行！必須嚴格按 1 → 2 → 3 → ... → 16 的順序

**Q: Flag 是什麼格式？**
A: 21 個字元，通常以 `flag{` 開頭

---

## 7. 技術細節

### 演算法
1. Double SHA512 Hash
2. Bit counting for each pin
3. Sorting by bit count (descending)
4. Assign ranks 1-16

### 資料結構
- `check_pins[16]`: 邏輯 Pin → GPIO Pin 映射
- `pins_order[16]`: 每個 Pin 的 rank (1-16)
- `pinStatesRow1/2`: 顯示當前線狀態 (o = 連接, x = 剪斷)

### 硬體
- 架構: RISC-V 32-bit (RP2040)
- GPIO 範圍: 0-30
- 總線數: 16
- 顯示器: SSD1306 OLED (128x64)

---

## 8. 工具使用

### 計算剪線順序
```bash
python3 calculate_full_sequence.py
# 輸入你的 seed
# 會生成 cutting_sequence_[seed].txt 檔案
```

### 查看輸出文件
```bash
cat cutting_sequence_deadbeef01.txt
```

---

## 9. 成功標誌

✅ 正確完成所有 16 個步驟後：
1. 顯示器顯示 "You win!"
2. 顯示 Flag（21 個字元）
3. 挑戰完成！

---

**準備好拆除炸彈了嗎？祝你好運！💣➔🏆**
